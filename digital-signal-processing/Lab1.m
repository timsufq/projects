% %Q1.1
% clear;
% x=rand(1,65536);
% y=rand(1,65213);
% tic
% fft(x);
% t1=toc;
% tic
% fft(y);
% t2=toc;
% t1
% t2

% %Q1.2
% clear;
% x_A=[1,1,1,1,0,0,0,0];
% x_B=[1,1,-1,0,1,0,-1,1];
% x_C=[1,1,1,1,-1,-1,-1,-1];
% x_D=[0,1,1,1,0,-1,-1,-1];
% y_A=fft(x_A,8);
% y_B=fft(x_B,8);
% y_C=fft(x_C,8);
% y_D=fft(x_D,8);

% %Q1.3
% clear;
% x=[1,1,1,1];
% figure(1);
% stem(0:(length(fft(x,4))-1),abs(fft(x,4)));
% figure(2);
% subplot(2,2,1);
% stem(0:(length(fft(x,8))-1),abs(fft(x,8)));
% subplot(2,2,2);
% stem(0:(length(fft(x,32))-1),abs(fft(x,32)));
% subplot(2,2,3);
% stem(0:(length(fft(x,128))-1),abs(fft(x,128)));
% subplot(2,2,4);
% stem(0:(length(fft(x,1024))-1),abs(fft(x,1024)));
% x_128=fft(x,128);
% x_1024=fft(x,1024);
% x_128_900=x_128(128*900/12800);
% x_1024_900=x_1024(1024*900/12800);
% x_128_900
% x_1024_900

% %Q2.1
% clear;
% x=[1,2,3,4,5,6,5,4,3,2,1,1];
% h=[1,4,6,4,1];
% y=conv(x,h);
% figure(1);
% stem(0:(length(y)-1),y);
% length_y=length(y)
% fft_x=fft(x,16);
% fft_h=fft(h,16);
% fft_y=fft(y,16);
% multi_xh=fft_x.*fft_h;
% figure(2);
% stem(0:(length(multi_xh)-1),abs(multi_xh));
% figure(3);
% stem(0:(length(fft_y)-1),abs(fft_y));

% %Q2.2
% clear;
% x=[1,2,3,4,5,6,5,4,3,2,1,1];
% h=[1,4,6,4,1];
% y=conv(x,h);
% fft_x_16=fft(x,16);
% fft_h_16=fft(h,16);
% fft_y_16=fft(y,16);
% multi_xh_16=fft_x_16.*fft_h_16;
% mean_square_difference_16=immse(abs(multi_xh_16),abs(fft_y_16));
% fft_x_32=fft(x,32);
% fft_h_32=fft(h,32);
% fft_y_32=fft(y,32);
% multi_xh_32=fft_x_32.*fft_h_32;
% mean_square_difference_32=immse(abs(multi_xh_32),abs(fft_y_32));
% mean_square_difference_16
% mean_square_difference_32

% %Q2.3
% clear;
% tic
% x=randn(1,102500);
% h=randn(1,1024);
% y=conv(x,h); 
% t_conv=toc;
% tic
% X_f=fft(x,2^20);
% H_f=fft(h,2^20);
% y2=ifft(X_f.*H_f);
% t_fftconv=toc;
% mean_square_difference_cf=immse(y,y2(1:103523));
% H_s=fft(h,2048);
% y3=zeros(1,103523);
% tic
% for r=0:99
%     xr=x(r*1025+1:(r+1)*1025);
%     Yr=fft(xr,2048).*H_s;
%     yr=ifft(Yr);
%     y3(r*1025+1:((r+1)*1025+1023))=y3(r*1025+1:((r+1)*1025+1023))+yr;
% end
% t_secc=toc;
% mean_square_difference_cs=immse(y,y3);
% t_conv
% t_fftconv
% t_secc
% mean_square_difference_cf
% mean_square_difference_cs

% %Q2.4
% clear;
% h=[1,4,6,4,1]/16;
% fft_h=fft(h,100);
% figure(1);
% subplot(2,1,1);
% stem(abs(fft_h));
% subplot(2,1,2);
% stem(angle(fft_h));
% m=max(fft_h);
% for i=1:100;
%     if abs(fft_h(i))<(m/sqrt(2));
%         break;
%     end
% end
% bandwidth=(i-1)*8000/100;
% bandwidth

% %Q2.5
% clear;
% h=[1,4,6,4,1]/16;
% i=0.001:0.001:0.1;
% x=0.1*rand(1,100);
% s=0.1*cos(2*pi*i*100);
% xx=x+s;
% figure(2);
% subplot(2,1,1);
% plot(xx);
% subplot(2,1,2);
% plot(conv(xx,h));
